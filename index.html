<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Android Action Mode</title>
<style>
body {
  margin: 0;
  background: black;
  overflow: hidden;
}

#wrap {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  position: relative;
}

video {
  position: absolute;
  width: 150%;
  height: 150%;
  top: -25%;
  left: -25%;
  object-fit: cover;
  transition: transform 0.03s linear;
}
</style>
</head>
<body>

<div id="wrap">
  <video id="video" autoplay playsinline></video>
</div>

<script>
const video = document.getElementById("video");

navigator.mediaDevices.getUserMedia({
  video: {
    facingMode: { exact: "environment" },
    frameRate: { ideal: 60 }
  },
  audio: false
}).then(stream => {
  video.srcObject = stream;
}).catch(() => {
  alert("Camera error.");
});

let smoothX = 0;
let smoothY = 0;
let smoothAngle = 0;

const smoothing = 0.05;   // stronger stabilization
const motionScale = 3;

window.addEventListener("devicemotion", (event) => {
  if (event.accelerationIncludingGravity) {
    let x = event.accelerationIncludingGravity.x;
    let y = event.accelerationIncludingGravity.y;

    smoothX += (x - smoothX) * smoothing;
    smoothY += (y - smoothY) * smoothing;

    let moveX = smoothX * motionScale;
    let moveY = smoothY * motionScale;

    video.style.transform =
      `translate(${-moveX}px, ${moveY}px) rotate(${-smoothAngle}deg)`;
  }
});

window.addEventListener("deviceorientation", (event) => {
  if (event.gamma !== null) {
    smoothAngle += (event.gamma - smoothAngle) * smoothing;
  }
});
</script>

</body>
</html>
